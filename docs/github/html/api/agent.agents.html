<!DOCTYPE html>

<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <meta charset='utf-8'/>
    <title>agent.agents package &#8212; Agent master documentation</title>
    <link rel='stylesheet' href='../_static/alabaster.css' type='text/css'/>
    <link rel='stylesheet' href='../_static/pygments.css' type='text/css'/>
    <link rel='stylesheet' type='text/css' href='../_static/graphviz.css'/>
    <script type='text/javascript' id='documentation_options' data-url_root='../'
            src='../_static/documentation_options.js'></script>
    <script type='text/javascript' src='../_static/jquery.js'></script>
    <script type='text/javascript' src='../_static/underscore.js'></script>
    <script type='text/javascript' src='../_static/doctools.js'></script>
    <script type='text/javascript' src='../_static/language_data.js'></script>
    <link rel='canonical' href='agent.neodroid.ml/api/agent.agents.html'/>
    <link rel='index' title='Index' href='../genindex.html'/>
    <link rel='search' title='Search' href='../search.html'/>
    <link rel='next' title='agents.utilities package' href='agent.utilities.html'/>
    <link rel='prev' title='agent package' href='agent.html'/>

    <link rel='stylesheet' href='../_static/custom.css' type='text/css'/>


    <meta name='viewport' content='width=device-width, initial-scale=0.9, maximum-scale=0.9'/>

  </head>
  <body>


    <div class='document'>
      <div class='documentwrapper'>
        <div class='bodywrapper'>


          <div class='body' role='main'>

            <div class='section' id='agent-agents-package'>
              <h1>agent.agents package<a class='headerlink' href='#agent-agents-package'
                                         title='Permalink to this headline'>¶</a></h1>
              <div class='section' id='submodules'>
                <h2>Submodules<a class='headerlink' href='#submodules'
                                 title='Permalink to this headline'>¶</a></h2>
              </div>
              <div class='section' id='module-agent.interfaces.partials.agents'>
                <span id='agent-interfaces-partials-agents-module'></span>
                <h2>agent.interfaces.partials.agents module<a class='headerlink'
                                                              href='#module-agent.interfaces.partials.agents'
                                                              title='Permalink to this headline'>¶</a></h2>
              </div>
              <div class='section' id='module-agent.agents.ppo_agent'>
                <span id='agent-agents-ppo-agent-module'></span>
                <h2>agent.agents.ppo_agent module<a class='headerlink' href='#module-agent.agents.ppo_agent'
                                                    title='Permalink to this headline'>¶</a></h2>
                <dl class='class'>
                  <dt id='agent.agents.ppo_agent.PPOAgent'>
                    <em class='property'>class </em><code class='sig-prename descclassname'>agent.agents.ppo_agent.</code><code
                      class='sig-name descname'>PPOAgent</code><span class='sig-paren'>(</span><em
                      class='sig-param'>*args</em>, <em class='sig-param'>**kwargs</em><span
                      class='sig-paren'>)</span><a class='reference internal'
                                                   href='../_modules/agent/agents/ppo_agent.html#PPOAgent'><span
                      class='viewcode-link'>[source]</span></a><a class='headerlink'
                                                                  href='#agent.agents.ppo_agent.PPOAgent'
                                                                  title='Permalink to this definition'>¶</a>
                  </dt>
                  <dd><p>Bases: <code class='xref py py-class docutils literal notranslate'><span class='pre'>agent.interfaces.partials.agents.torch_agents.actor_critic_agent.ActorCriticAgent</span></code>
                  </p>
                    <p>PPO, Proximal Policy Optimization method</p>
                    <p>See method __defaults__ for default parameters</p>
                    <dl class='method'>
                      <dt id='agent.agents.ppo_agent.PPOAgent.back_trace_advantages'>
                        <code class='sig-name descname'>back_trace_advantages</code><span
                          class='sig-paren'>(</span><em class='sig-param'>transitions</em><span
                          class='sig-paren'>)</span><a class='reference internal'
                                                       href='../_modules/agent/agents/ppo_agent.html#PPOAgent.back_trace_advantages'><span
                          class='viewcode-link'>[source]</span></a><a class='headerlink'
                                                                      href='#agent.agents.ppo_agent.PPOAgent.back_trace_advantages'
                                                                      title='Permalink to this definition'>¶</a>
                      </dt>
                      <dd></dd>
                    </dl>

                    <dl class='method'>
                      <dt id='agent.agents.ppo_agent.PPOAgent.evaluate'>
                        <code class='sig-name descname'>evaluate</code><span class='sig-paren'>(</span><em
                          class='sig-param'>batch</em>, <em class='sig-param'>_last_value_estimate</em>, <em
                          class='sig-param'>discrete=False</em>, <em class='sig-param'>**kwargs</em><span
                          class='sig-paren'>)</span><a class='reference internal'
                                                       href='../_modules/agent/agents/ppo_agent.html#PPOAgent.evaluate'><span
                          class='viewcode-link'>[source]</span></a><a class='headerlink'
                                                                      href='#agent.agents.ppo_agent.PPOAgent.evaluate'
                                                                      title='Permalink to this definition'>¶</a>
                      </dt>
                      <dd></dd>
                    </dl>

                    <dl class='method'>
                      <dt id='agent.agents.ppo_agent.PPOAgent.evaluate2'>
                        <code class='sig-name descname'>evaluate2</code><span class='sig-paren'>(</span><em
                          class='sig-param'>*</em>, <em class='sig-param'>states</em>, <em class='sig-param'>actions</em>,
                        <em class='sig-param'>log_probs</em>, <em class='sig-param'>returns</em>, <em
                          class='sig-param'>advantage</em>, <em class='sig-param'>**kwargs</em><span
                          class='sig-paren'>)</span><a class='reference internal'
                                                       href='../_modules/agent/agents/ppo_agent.html#PPOAgent.evaluate2'><span
                          class='viewcode-link'>[source]</span></a><a class='headerlink'
                                                                      href='#agent.agents.ppo_agent.PPOAgent.evaluate2'
                                                                      title='Permalink to this definition'>¶</a>
                      </dt>
                      <dd></dd>
                    </dl>

                    <dl class='method'>
                      <dt id='agent.agents.ppo_agent.PPOAgent.evaluate3'>
                        <code class='sig-name descname'>evaluate3</code><span class='sig-paren'>(</span><em
                          class='sig-param'>batch</em>, <em class='sig-param'>discrete=False</em>, <em
                          class='sig-param'>**kwargs</em><span class='sig-paren'>)</span><a
                          class='reference internal'
                          href='../_modules/agent/agents/ppo_agent.html#PPOAgent.evaluate3'><span
                          class='viewcode-link'>[source]</span></a><a class='headerlink'
                                                                      href='#agent.agents.ppo_agent.PPOAgent.evaluate3'
                                                                      title='Permalink to this definition'>¶</a>
                      </dt>
                      <dd></dd>
                    </dl>

                    <dl class='method'>
                      <dt id='agent.agents.ppo_agent.PPOAgent.inner_ppo_update'>
                        <code class='sig-name descname'>inner_ppo_update</code><span
                          class='sig-paren'>(</span><em class='sig-param'>states</em>, <em class='sig-param'>actions</em>,
                        <em class='sig-param'>log_probs</em>, <em class='sig-param'>returns</em>, <em
                          class='sig-param'>advantages</em><span class='sig-paren'>)</span><a
                          class='reference internal'
                          href='../_modules/agent/agents/ppo_agent.html#PPOAgent.inner_ppo_update'><span
                          class='viewcode-link'>[source]</span></a><a class='headerlink'
                                                                      href='#agent.agents.ppo_agent.PPOAgent.inner_ppo_update'
                                                                      title='Permalink to this definition'>¶</a>
                      </dt>
                      <dd></dd>
                    </dl>

                    <dl class='method'>
                      <dt id='agent.agents.ppo_agent.PPOAgent.kl_target_stop'>
                        <code class='sig-name descname'>kl_target_stop</code><span
                          class='sig-paren'>(</span><em class='sig-param'>old_log_probs</em>, <em
                          class='sig-param'>new_log_probs</em>, <em class='sig-param'>kl_target=0.03</em>, <em
                          class='sig-param'>beta_max=20</em>, <em class='sig-param'>beta_min=0.05</em><span
                          class='sig-paren'>)</span><a class='reference internal'
                                                       href='../_modules/agent/agents/ppo_agent.html#PPOAgent.kl_target_stop'><span
                          class='viewcode-link'>[source]</span></a><a class='headerlink'
                                                                      href='#agent.agents.ppo_agent.PPOAgent.kl_target_stop'
                                                                      title='Permalink to this definition'>¶</a>
                      </dt>
                      <dd><p>TRPO</p>
                        <p>negloss = -tf.reduce_mean(self.advantages_ph * tf.exp(self.logp - self.prev_logp))
                           negloss += tf.reduce_mean(self.beta_ph * self.kl_divergence)
                           negloss += tf.reduce_mean(self.ksi_ph * tf.square(tf.maximum(0.0,
                           self.kl_divergence - 2 *
                           self.kl_target)))</p>
                        <p>self.ksi = 10</p>
                        <p>Adaptive kl_target = 0.01
                           Adaptive kl_target = 0.03</p>
                        <dl class='field-list simple'>
                          <dt class='field-odd'>Parameters</dt>
                          <dd class='field-odd'>
                            <ul class='simple'>
                              <li><p><strong>kl_target</strong> – </p></li>
                              <li><p><strong>beta_max</strong> – </p></li>
                              <li><p><strong>beta_min</strong> – </p></li>
                              <li><p><strong>old_log_probs</strong> – </p></li>
                              <li><p><strong>new_log_probs</strong> – </p></li>
                            </ul>
                          </dd>
                          <dt class='field-even'>Returns</dt>
                          <dd class='field-even'><p></p>
                          </dd>
                        </dl>
                      </dd>
                    </dl>

                    <dl class='method'>
                      <dt id='agent.agents.ppo_agent.PPOAgent.ppo_mini_batch_iter'>
                        <em class='property'>static </em><code
                          class='sig-name descname'>ppo_mini_batch_iter</code><span class='sig-paren'>(</span><em
                          class='sig-param'>mini_batch_size: int</em>, <em class='sig-param'>states: Any</em>,
                        <em class='sig-param'>actions: Any</em>, <em class='sig-param'>log_probs: Any</em>,
                        <em class='sig-param'>returns: Any</em>, <em class='sig-param'>advantage:
                                                                                       Any</em><span
                          class='sig-paren'>)</span> &#x2192; iter<a class='reference internal'
                                                                     href='../_modules/agent/agents/ppo_agent.html#PPOAgent.ppo_mini_batch_iter'><span
                          class='viewcode-link'>[source]</span></a><a class='headerlink'
                                                                      href='#agent.agents.ppo_agent.PPOAgent.ppo_mini_batch_iter'
                                                                      title='Permalink to this definition'>¶</a>
                      </dt>
                      <dd></dd>
                    </dl>

                    <dl class='method'>
                      <dt id='agent.agents.ppo_agent.PPOAgent.react'>
                        <code class='sig-name descname'>react</code><span class='sig-paren'>(</span><span
                          class='sig-paren'>)</span><a class='reference internal'
                                                       href='../_modules/agent/agents/ppo_agent.html#PPOAgent.react'><span
                          class='viewcode-link'>[source]</span></a><a class='headerlink'
                                                                      href='#agent.agents.ppo_agent.PPOAgent.react'
                                                                      title='Permalink to this definition'>¶</a>
                      </dt>
                      <dd></dd>
                    </dl>

                    <dl class='method'>
                      <dt id='agent.agents.ppo_agent.PPOAgent.take_n_steps'>
                        <code class='sig-name descname'>take_n_steps</code><span class='sig-paren'>(</span><em
                          class='sig-param'>initial_state</em>, <em class='sig-param'>environment</em>, <em
                          class='sig-param'>n=100</em>, <em class='sig-param'>render=False</em>, <em
                          class='sig-param'>render_frequency=100</em><span class='sig-paren'>)</span><a
                          class='reference internal'
                          href='../_modules/agent/agents/ppo_agent.html#PPOAgent.take_n_steps'><span
                          class='viewcode-link'>[source]</span></a><a class='headerlink'
                                                                      href='#agent.agents.ppo_agent.PPOAgent.take_n_steps'
                                                                      title='Permalink to this definition'>¶</a>
                      </dt>
                      <dd></dd>
                    </dl>

                    <dl class='method'>
                      <dt id='agent.agents.ppo_agent.PPOAgent.update_models'>
                        <code class='sig-name descname'>update_models</code><span
                          class='sig-paren'>(</span><em class='sig-param'>*</em>, <em class='sig-param'>stat_writer=None</em>,
                        <em class='sig-param'>**kwargs</em><span class='sig-paren'>)</span> &#x2192; None<a
                          class='reference internal'
                          href='../_modules/agent/agents/ppo_agent.html#PPOAgent.update_models'><span
                          class='viewcode-link'>[source]</span></a><a class='headerlink'
                                                                      href='#agent.agents.ppo_agent.PPOAgent.update_models'
                                                                      title='Permalink to this definition'>¶</a>
                      </dt>
                      <dd></dd>
                    </dl>

                    <dl class='method'>
                      <dt id='agent.agents.ppo_agent.PPOAgent.update_targets'>
                        <code class='sig-name descname'>update_targets</code><span
                          class='sig-paren'>(</span><em class='sig-param'>*args</em>, <em class='sig-param'>**kwargs</em><span
                          class='sig-paren'>)</span> &#x2192; None<a class='reference internal'
                                                                     href='../_modules/agent/agents/ppo_agent.html#PPOAgent.update_targets'><span
                          class='viewcode-link'>[source]</span></a><a class='headerlink'
                                                                      href='#agent.agents.ppo_agent.PPOAgent.update_targets'
                                                                      title='Permalink to this definition'>¶</a>
                      </dt>
                      <dd></dd>
                    </dl>

                  </dd>
                </dl>

                <dl class='function'>
                  <dt id='agent.agents.ppo_agent.ppo_test'>
                    <code class='sig-prename descclassname'>agent.agents.ppo_agent.</code><code
                      class='sig-name descname'>ppo_test</code><span class='sig-paren'>(</span><em
                      class='sig-param'>rollouts=None</em>, <em class='sig-param'>skip=True</em><span
                      class='sig-paren'>)</span><a class='reference internal'
                                                   href='../_modules/agent/agents/ppo_agent.html#ppo_test'><span
                      class='viewcode-link'>[source]</span></a><a class='headerlink'
                                                                  href='#agent.agents.ppo_agent.ppo_test'
                                                                  title='Permalink to this definition'>¶</a>
                  </dt>
                  <dd></dd>
                </dl>

              </div>
              <div class='section' id='module-agent.agents'>
                <span id='module-contents'></span>
                <h2>Module contents<a class='headerlink' href='#module-agent.agents'
                                      title='Permalink to this headline'>¶</a></h2>
              </div>
            </div>


          </div>

        </div>
      </div>
      <div class='sphinxsidebar' role='navigation' aria-label='main navigation'>
        <div class='sphinxsidebarwrapper'>
          <h1 class='logo'><a href='../index.html'>Agent</a></h1>


          <h3>Navigation</h3>
          <p class='caption'><span class='caption-text'>Notes</span></p>
          <ul>
            <li class='toctree-l1'><a class='reference internal' href='../getting_started.html'>Getting
                                                                                                Started</a>
            </li>
            <li class='toctree-l1'><a class='reference internal' href='../concepts.html'>Core Concepts</a>
            </li>
            <li class='toctree-l1'><a class='reference internal' href='../cli.html'>CLI Reference</a></li>
            <li class='toctree-l1'><a class='reference internal' href='../experiments.html'>Experiments</a>
            </li>
            <li class='toctree-l1'><a class='reference internal' href='../readme.html'>Readme File</a></li>
          </ul>
          <p class='caption'><span class='caption-text'>API</span></p>
          <ul class='current'>
            <li class='toctree-l1'><a class='reference internal' href='agent.html'>agent package</a></li>
            <li class='toctree-l1 current'><a class='current reference internal' href='#'>agent.agents
                                                                                          package</a></li>
            <li class='toctree-l1'><a class='reference internal' href='agent.utilities.html'>agents.utilities
                                                                                             package</a></li>
            <li class='toctree-l1'><a class='reference internal' href='modules.html'>Agent</a></li>
          </ul>

          <div class='relations'>
            <h3>Related Topics</h3>
            <ul>
              <li><a href='../index.html'>Documentation overview</a>
                <ul>
                  <li><a href='agent.html'>agent package</a>
                    <ul>
                      <li>Previous: <a href='agent.html' title='previous chapter'>agent package</a></li>
                      <li>Next: <a href='agent.utilities.html' title='next chapter'>agents.utilities
                                                                                    package</a></li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
          <div id='searchbox' style='display: none' role='search'>
            <h3 id='searchlabel'>Quick search</h3>
            <div class='searchformwrapper'>
              <form class='search' action='../search.html' method='get'>
                <input type='text' name='q' aria-labelledby='searchlabel'/>
                <input type='submit' value='Go'/>
              </form>
            </div>
          </div>
          <script type='text/javascript'>$('#searchbox').show(0);</script>


        </div>
      </div>
      <div class='clearer'></div>
    </div>
    <div class='footer'>
      &copy;2017, Christian Heider Nielsen.

      |
      Powered by <a href='http://sphinx-doc.org/'>Sphinx 2.1.0</a>
      &amp; <a href='https://github.com/bitprophet/alabaster'>Alabaster 0.7.12</a>

      |
      <a href='../_sources/api/agent.agents.rst.txt'
         rel='nofollow'>Page source</a>
    </div>


  </body>
</html>